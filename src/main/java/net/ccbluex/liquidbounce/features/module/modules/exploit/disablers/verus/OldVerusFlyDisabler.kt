/*
 * FDPClient Hacked Client
 * A free open source mixin-based injection hacked client for Minecraft using Minecraft Forge by LiquidBounce.
 * https://github.com/SkidderMC/FDPClient/
 */
package net.ccbluex.liquidbounce.features.module.modules.exploit.disablers.verus

import net.minecraft.network.play.client.C03PacketPlayer
import net.ccbluex.liquidbounce.event.PacketEvent
import net.ccbluex.liquidbounce.features.module.modules.exploit.disablers.DisablerMode

class OldVerusFlyDisabler  : DisablerMode("OldVerus-Fly") {

    private var packetCount = 0

    override fun onPacket(event: PacketEvent) {
        val packet = event.packet
        if (packet is C03PacketPlayer) {
            if (mc.thePlayer.motionY == 0.0 || mc.thePlayer.onGround || mc.thePlayer.isCollidedVertically) {
                packet.onGround = true
                disabler.debugMessage("fix ground")
            }
        }
        if (packet is C03PacketPlayer) {
            if (packet !is C03PacketPlayer.C04PacketPlayerPosition && packet !is C03PacketPlayer.C05PacketPlayerLook && packet !is C03PacketPlayer.C06PacketPlayerPosLook) {
                packetCount++
                if (packetCount >= 2) {
                    event.cancelEvent()
                }
            } else {
                packetCount = 0
                disabler.debugMessage("set 0")
            }
        }
    }

}